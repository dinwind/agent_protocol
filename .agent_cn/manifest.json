{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "name": "agent-protocol",
  "version": "2.1.0",
  "description": "AI Agent 协作协议 - 标准化数字资产",
  
  "directory_name": ".agent_cn",
  "directory_name_comment": "协议目录名，文档中使用 $AGENT_DIR 占位符引用",
  
  "loading_strategy": {
    "layers": {
      "essential": {
        "description": "核心必读文件，每次会话必须加载",
        "load": "always",
        "token_budget": 3000,
        "files": [
          "start-here.md",
          "quick-reference.md",
          "core/core-rules.md"
        ]
      },
      "context": {
        "description": "项目上下文，会话开始时加载",
        "load": "session_start",
        "token_budget": 2000,
        "files": [
          "core/instructions.md",
          "project/context.md",
          "project/tech-stack.md",
          "project/known-issues.md"
        ]
      },
      "stack_specs": {
        "description": "技术栈规约，按项目技术栈选择加载",
        "load": "on_demand",
        "selector": "project.primary_stack",
        "options": {
          "python": ["core/stack-specs/python.md"],
          "rust": ["core/stack-specs/rust.md"],
          "qt": ["core/stack-specs/qt.md"],
          "mixed": [
            "core/stack-specs/python.md",
            "core/stack-specs/rust.md"
          ]
        }
      },
      "workflows": {
        "description": "工作流规范，按任务类型加载",
        "load": "on_demand",
        "trigger": "task_type",
        "mappings": {
          "coding": ["core/workflows/bug-prevention.md", "core/workflows/design-principles.md"],
          "testing": ["core/workflows/testing.md"],
          "documentation": ["core/workflows/documentation.md"],
          "review": ["core/workflows/review-process.md", "core/workflows/quality-assurance.md"],
          "planning": ["core/workflows/pre-task-checklist.md", "core/workflows/ai-boundaries.md"]
        }
      },
      "skills": {
        "description": "技能模块，按需加载",
        "load": "on_demand",
        "trigger": "skill_request",
        "modules": {
          "interface": {
            "entry": "skills/skill-interface.md",
            "description": "技能开发接口规范"
          },
          "guardian": {
            "entry": "skills/guardian/SKILL.md",
            "description": "代码/文档质量检查"
          },
          "ai-integration": {
            "entry": "skills/ai-integration/llm-client.md",
            "files": [
              "skills/ai-integration/llm-client.md",
              "skills/ai-integration/prompt-engineering.md",
              "skills/ai-integration/domain-adaptation.md"
            ],
            "description": "AI/LLM 集成开发"
          },
          "agent-governance": {
            "entry": "skills/agent-governance/SKILL.md",
            "description": "协议健康检查"
          }
        }
      },
      "reference": {
        "description": "参考文档，查阅时加载",
        "load": "on_demand",
        "files": [
          "core/conventions.md",
          "core/stack-specs/git.md",
          "core/security.md",
          "core/examples.md",
          "meta/protocol-adr.md"
        ]
      }
    },
    
    "task_profiles": {
      "code_review": {
        "description": "代码审查任务",
        "layers": ["essential", "context", "stack_specs"],
        "workflows": ["review"],
        "skills": ["guardian"]
      },
      "feature_development": {
        "description": "功能开发任务",
        "layers": ["essential", "context", "stack_specs"],
        "workflows": ["coding", "testing"],
        "skills": []
      },
      "bug_fix": {
        "description": "Bug 修复任务",
        "layers": ["essential", "context", "stack_specs"],
        "workflows": ["coding"],
        "skills": ["guardian"]
      },
      "documentation": {
        "description": "文档编写任务",
        "layers": ["essential", "context"],
        "workflows": ["documentation"],
        "skills": []
      },
      "ai_integration": {
        "description": "AI 集成开发任务",
        "layers": ["essential", "context", "stack_specs"],
        "workflows": ["coding", "testing"],
        "skills": ["ai-integration"]
      }
    }
  },
  
  "required_files": [
    "start-here.md",
    "index.md",
    "core/core-rules.md",
    "core/instructions.md",
    "core/conventions.md",
    "project/context.md",
    "project/tech-stack.md",
    "meta/protocol-adr.md"
  ],
  
  "naming_conventions": {
    "markdown_files": "^[a-z0-9]+(-[a-z0-9]+)*\\.md$",
    "directories": "^[a-z0-9]+(-[a-z0-9]+)*$",
    "exceptions": ["MANIFEST.json", "VERSION", "SKILL.md"]
  },
  
  "compatibility": {
    "min_version": "2.0.0",
    "breaking_changes": [
      {
        "version": "2.0.0",
        "description": "协议统一合并，目录结构变更"
      }
    ]
  },
  
  "metadata": {
    "created": "2026-01-23",
    "updated": "2026-01-23",
    "maintainer": "AI Agent Protocol Team"
  }
}
