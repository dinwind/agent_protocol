# 核心协作哲学 (Core Philosophy)

本文件定义了**不可妥协**的最高原则。无论使用何种编程语言或智能体，必须严格遵守。

---

## 0. 协作价值观 (Core Values)

- **长期主义 (Long-termism)**：规则的制定不应仅解决当前问题，而应着眼于项目全生命周期的经验传承。
- **资产化 (Assetization)**：`.agent` 目录被视为与源代码同等重要的数字资产，必须保持其独立性与可移植性。
- **防腐蚀 (Anti-corrosion)**：通过严格的物理与逻辑隔离，防止 AI 辅助工具污染业务代码，保持代码库的纯净度。

---

## 1. 三不原则 (Three Prohibitions)

### 1.1 离线优先 - 禁止外链 (Offline First)
- **禁止**引入任何外部 CDN 链接（如 Google Fonts, Material Icons, Bootstrap CDN 等）
- **禁止**依赖需要联网才能运行的第三方 API（除非明确要求）
- **要求**：所有资源（字体、图标、库）必须本地化并集成在项目代码库中

### 1.2 无损交互 - 禁止硬跳变 (Lossless Interaction)
- **禁止**任何视觉状态的"硬跳变"（即无过渡的显隐、位移或颜色变化）
- **要求**：所有 UI 变更必须附带平滑动画（推荐时长 250ms - 300ms）
- **要求**：布局变动中（如侧边栏折叠），关键元素重心必须保持稳定

### 1.3 显式安全 - 禁止未授权 API (Explicit Security)
- **禁止**在未经过权限校验的情况下暴露任何管理类 API
- **要求**：所有敏感操作必须记录审计日志
- **要求**：认证机制必须安全可靠

---

## 2. 智能层隔离 (Intelligence Layer Isolation, ILI)

### 2.1 物理隔离
`.agent` 目录是项目的"智能大脑"，其内部的脚本、环境、配置**严禁泄露**至项目根目录或业务子目录。

### 2.2 逻辑隔离
- 业务代码**禁止**调用 `.agent` 下的任何脚本
- `.agent` 下的工具**禁止**直接 `import` 业务代码（仅允许通过文件系统进行扫描和分析）

### 2.3 引擎与实例分离 (Engine-Instance Separation) ⭐⭐⭐

`.agent` 内部文件分为两类：

| 类型 | 目录 | 职能 | 规则 |
|------|------|------|------|
| **引擎文件** | `core/` | 通用治理规则 | 严禁包含任何特定项目的业务名称、路径或逻辑 |
| **实例文件** | `project/` | 项目特定信息 | 所有项目相关描述必须收口于此 |

**强制规则**：
> 引擎文件（`core/` 目录下）严禁出现当前项目的具体名称或业务路径。所有此类信息必须引用 `project/context.md` 中的定义。

### 2.4 零污染迁移
`.agent` 必须设计为"即插即用"：
- 删除该目录**不应影响**主项目的构建、运行或测试
- 复制该目录到新项目**应能立即工作**

### 2.5 适配器模式对接 (Adapter Pattern Integration) ⭐⭐⭐

针对特定 AI 工具（如 GitHub Copilot, Cursor）的配置文件，应采用**指针策略**：
- **禁止**在工具专用配置（如 `.github/copilot-instructions.md`）中硬编码大量规则。
- **强制**将其作为"连接器"，只包含指向 `.agent` 协议栈的指针和权重定义。
- 适配器模板应统一存放于 `adapters/` 目录中。

---

## 3. 交付质量 (Delivery Quality)

### 3.1 编码规范
- 所有源代码和配置文件必须使用 **UTF-8** 编码。
- 读写文件时，必须**显式设置**编码为 UTF-8。具体实现见 [core/examples.md](examples.md#1-utf-8-explicit-encoding)。

### 3.2 文件命名规范
`.agent` 目录下**所有** markdown 文件必须使用**小写字母+连字符**（kebab-case）。**无例外！**

| 类型 | 正确示例 ✅ | 错误示例 ❌ |
|------|------------|------------|
| 文件名 | `readme.md`, `start-here.md`, `project-context.md` | `README.md`, `StartHere.md`, `projectContext.md` |
| 目录名 | `workflows`, `bug-prevention`, `design-principles` | `Workflows`, `Bug_Prevention`, `DesignPrinciples` |

### 3.3 规则一致性 (Rule Consistency)
所有技术栈规约适用于项目内**所有**相关后缀的文件，无论其用途是业务功能、辅助工具还是临时脚本。

---

## 4. 工作流程准则

### 4.1 工作区感知
始终以项目根目录作为主执行上下文，不要随意切换到子目录执行命令。

### 4.2 路径分隔符规范 ⭐
在命令行中始终使用**正斜杠 `/`** 作为路径分隔符，跨平台兼容 Windows 和 Unix shell 环境。

### 4.3 终端编码规范 ⭐
终端输出必须使用 **UTF-8 编码**，防止非 ASCII 字符显示乱码。

### 4.4 增量验证 (Incremental Verification)
每个模块开发完成后，必须先验证闭环（编译、运行、测试），确认功能正常后再继续下一个模块。

### 4.5 同步测试 (Synchronous Testing)
开发新功能时，必须同步开发对应的测试方案，确保功能交付即具备可验证性。

### 4.6 测试数据隔离 (Test Data Isolation) ⭐⭐⭐
自动化测试必须使用动态生成的标识符和专用前缀 `autotest_`，严禁使用固定名称导致冲突。具体实现见 [core/examples.md](examples.md#2-test-data-isolation)。

---

## 5. 完整交付自检清单

在提交任何功能或修复之前，必须完成以下检查：

- [ ] **代码质量**: 符合命名规范，显式指定 UTF-8 编码，异常处理完善。
- [ ] **测试覆盖**: 新功能有对应测试用例，测试数据使用动态 RunID。
- [ ] **性能指标**: 应用启动与关键操作响应时间合理，无明显退化。
- [ ] **文档同步**: README、API 文档与 Bug 预防手册已同步更新。

---

*此文件为通用引擎规则，禁止包含任何项目特定信息*
*协议版本: 2.1.0*
